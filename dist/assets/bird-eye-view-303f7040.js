import{r as i,g as z,j as n}from"./index-a4988a1a.js";import{S as B,c as N,u as Y,e as Z,a as C,U as m}from"./api_utils-23744359.js";import{c as aa,d as h,T as ea,a as ta,e as na}from"./TableRow-a82b3170.js";import{B as D}from"./Button-6b03edc8.js";import{a as sa,U as ia,b as ra,T as oa,e as la,c as da,g as ca}from"./utils-25e18a3b.js";import{c as pa}from"./date_time-4d7aa2d3.js";import{C as ga}from"./Container-c0506722.js";import{G as ha}from"./Grid-54f8f6e5.js";import{C as xa}from"./Card-9079bfb2.js";import{T as ua}from"./TablePagination-cc10fb6b.js";import"./TableSortLabel-ace32273.js";import"./MenuItem-540228da.js";import"./Menu-984ec5d5.js";import"./Select-35be87cd.js";import"./InputAdornment-a6d815f6.js";import"./FormGroup-f0962c3e.js";function fa({selected:k,name:$,currentWeek:d,isNotify:E,id:c,pack:x,pain:j,row:A,selectedColumns:s,url:S,totalWeeks:p,status:o,index:u,start_date:v,end_date:_,handleClick:W,upliftState:R,handleEdit:q,handleDelete:U,assign_to:P}){i.useState(null);const[T,f]=i.useState();i.useEffect(()=>{var g;let e=(g=z("data"))==null?void 0:g.type_id;f(e)});const b=async e=>{console.log("data to update",e);const g=await N(Y,e);R(),console.log("<><><><><><>",g)};return n.jsxs(aa,{hover:!0,tabIndex:-1,children:[(s==null?void 0:s.includes("Name"))&&n.jsx(h,{children:$}),(s==null?void 0:s.includes("Package"))&&n.jsx(h,{children:x==1?"Fitnat Coaching Premium":x==2?"Fitnat Coaching Delux":"Fitnat Personal Training"}),(s==null?void 0:s.includes("Link"))&&n.jsx(h,{align:"center",children:n.jsx(D,{variant:"outlined",href:S.startsWith("https://")?S:"https://"+S,size:"small",color:"success",children:"link"})}),(s==null?void 0:s.includes("Start Date"))&&n.jsx(h,{align:"center",children:new Date(v).toLocaleString().split(",")[0]}),(s==null?void 0:s.includes("End Date"))&&n.jsx(h,{align:"center",children:new Date(_).toLocaleString().split(",")[0]}),(s==null?void 0:s.includes("Pain"))&&n.jsx(h,{children:j}),(s==null?void 0:s.includes("Assign To"))&&n.jsx(h,{children:P}),Array.from({length:12},(e,g)=>g).map(e=>s.includes(`Week ${e+1}`)&&n.jsxs(h,{id:`index${e}`,align:"center",sx:{backgroundColor:E&&e+1===d?"#76bfff":e+1===d&&"#e4eaec",borderRadius:e+1===d&&"20px 0px 20px 0px",padding:1},children:[n.jsx(D,{variant:"contained",size:"small",color:o[`week${e+1}u1`]==1?"success":o[`week${e+1}u1`]==0&&e+1<d?"info":"error",disabled:e+1>p,onClick:()=>b({id:c,table:B,[`week${e+1}u1`]:o[`week${e+1}u1`]==1?0:1}),style:{minWidth:"40px",padding:"4px 8px"},children:(T==1,"1")}),n.jsx(D,{variant:"contained",size:"small",sx:{margin:"10px"},color:o[`week${e+1}u2`]==1?"success":o[`week${e+1}u2`]==0&&e+1<d?"info":"error",style:{minWidth:"40px",padding:"4px 8px"},disabled:e+1>p,onClick:()=>b({id:c,table:B,[`week${e+1}u2`]:o[`week${e+1}u2`]==1?0:1}),children:(T==1,"2")}),T==2&&n.jsx(D,{variant:"contained",size:"small",sx:{margin:"10px"},color:o[`week${e+1}u3`]==1?"success":o[`week${e+1}u3`]==0&&e+1<d?"info":"error",style:{minWidth:"40px",padding:"4px 8px"},disabled:e+1>p,onClick:()=>b({id:c,table:B,[`week${e+1}u3`]:o[`week${e+1}u3`]==1?0:1}),children:"3"})]}))]})}function Na(){const[k,$]=i.useState([]),[d,E]=i.useState(new Map),[c,x]=i.useState(0),[j,A]=i.useState("asc"),[s,S]=i.useState("assign_to"),[p,o]=i.useState(""),[u,v]=i.useState(15),[_,W]=i.useState(!1),[R,q]=i.useState(!0);let U=[{id:"name",label:"Name"},{id:"package",label:"Package"},{id:"link",label:"Link"},{id:"start_date",label:"Start Date"},{id:"end_date",label:"End Date"},{id:"pain",label:"Pain"},{id:"assign_to",label:"Assign To"},...Array.from({length:12},(a,r)=>`Week ${r+1}`).map((a,r)=>({id:`${a}-${r}`,label:a}))];const[P,T]=i.useState(U.map(a=>a.label)),f=z("data"),b=f==null?void 0:f.type_id;console.log("loggedInUser",f),i.useEffect(()=>{const a=async()=>{var y;try{const l=await N(Z),J=(await N(C,{table:m})).data.data,Q=new Date,L=(y=l==null?void 0:l.data)==null?void 0:y.map(t=>{var M,O;return{...t==null?void 0:t.patient_master,id:t==null?void 0:t.id,totalWeeks:(M=pa(t==null?void 0:t.patient_master))==null?void 0:M.totalWeeks,currentWeek:t==null?void 0:t.currentWeek,isNotify:t==null?void 0:t.isNotify,status:r(t),type_id:(O=t==null?void 0:t.patient_master)==null?void 0:O.type_id}}).filter(t=>new Date(t.end_date)>=Q&&(t==null?void 0:t.creator.type_id)===b),X=new Map(J.map(t=>[t.id,t.name]));E(X),$(L),console.log("Data is ",L)}catch(l){console.error("Failed to fetch users:",l)}},r=y=>Object.keys(y).filter(l=>l.startsWith("week")).reduce((l,F)=>(l[F]=y[F],l),{});a()},[_,b]);const e=(a,r)=>{A(s===r&&j==="asc"?"desc":"asc"),S(r)},g=a=>{x(0),o(a.target.value)},G=()=>{W(!_)},I=sa({inputData:k,comparator:ca(j,s),filterName:p,filterBy:"assign_to"}),V=!I.length&&!!p,w=(a,r)=>{x(r)},H=a=>{x(0),v(parseInt(a.target.value,10))},K=a=>{setCurrentUser(a),setIsEditing(!0),setOpenDialog(!0)};return n.jsx(ga,{sx:{display:"flex"},children:n.jsxs(ha,{xs:12,md:2,margin:5,children:[n.jsx("div",{children:n.jsx(D,{onClick:()=>navigate("/patients"),variant:"contained",color:"primary",children:"Exit"})}),n.jsxs(xa,{sx:{marginTop:"10px"},children:[n.jsx(ia,{numSelected:0,filterName:p,handleSelectedColumns:T,onFilterName:g,showFilterButton:R}),n.jsx(ea,{sx:{overflow:"auto"},children:n.jsxs(ta,{sx:{minWidth:800},children:[n.jsx(ra,{order:j,orderBy:s,onRequestSort:e,rowCount:k.length,headLabel:U.filter(a=>P.includes(a.label))}),n.jsxs(na,{children:[I.slice(c*u,c*u+u).map((a,r)=>n.jsx(fa,{selectedColumns:P,id:a.id,index:r,currentWeek:a==null?void 0:a.currentWeek,isNotify:a==null?void 0:a.isNotify,totalWeeks:a==null?void 0:a.totalWeeks,selected:!1,name:a.name,upliftState:G,status:a==null?void 0:a.status,pack:a.package,url:a.url,pain:a.pain,start_date:a==null?void 0:a.start_date,end_date:a==null?void 0:a.end_date,assign_to:d.get(a.assign_to),handleEdit:()=>K(a),handleDelete:()=>handleDelete(a.id)},a.id)),n.jsx(oa,{height:77,emptyRows:la(c,u,k.length)}),V&&n.jsx(da,{query:p})]})]})}),n.jsx(ua,{page:c,component:"div",count:k.length,rowsPerPage:u,onPageChange:w,rowsPerPageOptions:[15,25,50],onRowsPerPageChange:H})]})]})})}export{Na as default};
