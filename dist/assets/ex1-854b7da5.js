import{r as i,j as e,c as Ae,B as ee,d as ke,T as ae,I as se,a as U,g as J,S as we,b as Ne}from"./index-a4988a1a.js";import{Q as Fe,B as S}from"./ReactToastify-f3c55358.js";import{c as D,a as X,U as Le,P as M,u as Ee,b as We,d as Ue}from"./api_utils-23744359.js";import{f as Z}from"./date_time-4d7aa2d3.js";import{U as Me}from"./user-table-head-e872ebc0.js";import{c as Re,d as c,T as Oe,a as Be,e as He}from"./TableRow-a82b3170.js";import{B as T}from"./Button-6b03edc8.js";import{O as te,F as R,S as O}from"./Select-35be87cd.js";import{I as Pe}from"./InputAdornment-a6d815f6.js";import{C as ze}from"./confirmation_dialog-edc11ed1.js";import{C as Ye}from"./Container-c0506722.js";import{C as qe}from"./Card-9079bfb2.js";import{C as Ge}from"./CircularProgress-70f270e3.js";import{T as Ke}from"./TablePagination-cc10fb6b.js";import{D as Qe,a as Ve,b as Je,c as Xe}from"./DialogTitle-3bb374e8.js";import{G as g}from"./Grid-54f8f6e5.js";import{T as b,I as B}from"./TextField-3549197f.js";import{M as C,C as Ze}from"./MenuItem-540228da.js";import{L as $e}from"./TableSortLabel-ace32273.js";import"./Menu-984ec5d5.js";function ea({row:l,handleEdit:r,sr:n,isAdmin:d,handleDelete:u,teammates:o,handleAssignChange:m}){var f,_;return i.useState(null),e.jsxs(Re,{hover:!0,tabIndex:-1,children:[e.jsx(c,{children:n}),e.jsx(c,{children:l.name}),e.jsx(c,{children:l.mobile}),e.jsx(c,{children:l.city+"/"+l.country}),e.jsx(c,{children:(_=(f=l.pain)==null?void 0:f.split(","))==null?void 0:_.join(`
`)}),e.jsx(c,{children:e.jsx("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",children:l.url})}),e.jsx(c,{children:new Date(l.start_date).toLocaleDateString()}),e.jsx(c,{children:new Date(l.end_date).toLocaleDateString()}),e.jsx(c,{children:Ae(l.package)}),e.jsx(c,{children:o}),e.jsx(c,{children:l.type_id==1?"Dr. Dhairya":"Dr. Nidhi"}),e.jsx(c,{align:"right",children:e.jsxs(ee,{display:"flex",justifyContent:"flex-end",children:[e.jsx(T,{variant:"contained",disabled:!d,size:"small",onClick:r,color:"primary",sx:{marginRight:1},children:"Edit"}),e.jsx(T,{variant:"contained",disabled:!d,size:"small",color:"error",onClick:()=>u(l.id),children:"Delete"})]})})]},l.id)}function le({numSelected:l,filterName:r,onFilterName:n}){return e.jsx(ke,{sx:{height:96,display:"flex",justifyContent:"space-between",p:d=>d.spacing(0,1,0,3),...l>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:l>0?e.jsxs(ae,{component:"div",variant:"subtitle1",children:[l," selected"]}):e.jsx(te,{value:r,onChange:n,placeholder:"Search user...",startAdornment:e.jsx(Pe,{position:"start",children:e.jsx(se,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})})})}le.propTypes={numSelected:U.number,filterName:U.string,onFilterName:U.func};function $(l,r,n){return l[n]===null?1:r[n]===null||r[n]<l[n]?-1:r[n]>l[n]?1:0}function aa(l,r){return l==="desc"?(n,d)=>$(n,d,r):(n,d)=>-$(n,d,r)}const sa=({inputData:l,comparator:r,filterName:n,getTeammateName:d})=>{const u=l.map((o,m)=>[o,m]);return u.sort((o,m)=>{const f=r(o[0],m[0]);return f!==0?f:o[1]-m[1]}),n?u.map(o=>o[0]).filter(o=>{const m=o.assign_to?d(o.assign_to):"";return o.name.toLowerCase().indexOf(n.toLowerCase())!==-1||m.toLowerCase().indexOf(n.toLowerCase())!==-1}):u.map(o=>o[0])};function Sa(){const[l,r]=i.useState([]),[n,d]=i.useState(0),[u,o]=i.useState("asc"),[m,f]=i.useState("name"),[_,H]=i.useState(!1),[k,ne]=i.useState([]),[w,ie]=i.useState(""),[I,oe]=i.useState(10),[P,N]=i.useState(!1),[a,y]=i.useState(null),[F,L]=i.useState(!1),[A,E]=i.useState(!1),[re,de]=i.useState(-1),[ce,z]=i.useState(!1),[Y,me]=i.useState(),he=["Headache","Neck Pain","Shoulder Pain","Back Pain","Hip Pain","Knee Pain","Ankle Pain","Foot Pain","Elbow Pain","Wrist Pain","Hand Pain","Chest Pain"];i.useEffect(()=>{var t;ue(),ge();let s=(t=J("data"))==null?void 0:t.isMaster;me(s)},[A]);const ge=async()=>{try{const s=await D(X,{table:Le});ne(Array.isArray(s.data.data)?s.data.data:[]),console.log("User-masters data:",s.data.data)}catch(s){console.error("Failed to fetch teammates:",s)}},xe=(s,t)=>{r(h=>h.map(j=>j.id===s?{...j,assign_to:t}:j))},ue=async()=>{try{z(!0);const s=await D(X,{table:M});console.log(">>>>>>>",s),r(s.data.data),z(!1)}catch(s){console.error("Failed to fetch patient:",s)}},pe=(s,t)=>{o(m===t&&u==="asc"?"desc":"asc"),f(t)},je=(s={})=>{var v;let t=Z(s==null?void 0:s.start_date),h=Z(s==null?void 0:s.end_date),j=(v=s==null?void 0:s.pain)==null?void 0:v.split(",");s.start_date=t,s.end_date=h,s.pain=j,y(s),L(!0),N(!0)},fe=s=>{try{H(!0),de(s)}catch(t){console.error("Failed to delete patient:",t)}},W=()=>{N(!1),y({}),L(!1)},be=async()=>{var h,j,v,K,Q,V;if(!(a!=null&&a.start_date)||!(a!=null&&a.end_date)||new Date(a==null?void 0:a.start_date)>=new Date(a==null?void 0:a.end_date)||new Date(a==null?void 0:a.end_date)-new Date(a==null?void 0:a.start_date)>72576e5){S.error("Please select valid dates and period should extend more than 12 weeks");return}if(console.log(a==null?void 0:a.pain),!((h=a==null?void 0:a.name)!=null&&h.trim())||!((j=a==null?void 0:a.city)!=null&&j.trim())||!((v=a==null?void 0:a.country)!=null&&v.trim())||!((Q=(K=a==null?void 0:a.pain)==null?void 0:K.join())!=null&&Q.length)||!(a!=null&&a.package)||!((V=a==null?void 0:a.url)!=null&&V.trim())){S.error("please provide all Details");return}let t=a==null?void 0:a.pain.join(",");if(a.pain=t,F)try{let x=await D(Ee,{...a,table:M});E(!A),console.log("response",x),S.success("Patient Updated Successfully")}catch(x){console.error("Failed to update patient:",x),S.error("Failed to update patient")}else{const x=J("data");console.log("Patient",a);const Ie=await D(We,{...a,type_id:x==null?void 0:x.type_id,created_by:x==null?void 0:x.id});E(!A),console.log(">>>>>>>",Ie),S.success("New Patient Added Successfully")}W()},Ce=s=>{const{value:t}=s.target;y({...a,assign_to:t})},q=s=>{const t=Array.isArray(k)?k.find(h=>h.id===s):null;return t?t.name:""},ye=()=>{L(!1),N(!0)},ve=(s,t)=>{d(t)},Se=s=>{d(0),oe(parseInt(s.target.value,10))},De=s=>{d(0),ie(s.target.value)},p=s=>{const{name:t,value:h}=s.target;y({...a,[t]:h})},G=sa({inputData:l,comparator:aa(u,m),filterName:w,getTeammateName:q}),Te=async s=>{if(console.log(">>>>>",s),s){let t=await D(Ue,{table:M,id:re});E(!A),console.log("response",t)}H(!1)},_e=s=>{const{target:{value:t}}=s;console.log(t),y({...a,pain:t})};return G.length,e.jsxs(Ye,{maxWidth:"xl",children:[e.jsx(Fe,{position:"top-right"}),e.jsxs(we,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[e.jsx(ae,{variant:"h4",children:"Patients"}),Y&&e.jsx(T,{variant:"contained",color:"inherit",startIcon:e.jsx(se,{icon:"eva:plus-fill"}),onClick:ye,children:"New Patient"})]}),e.jsxs(qe,{children:[e.jsx(le,{numSelected:0,filterName:w,onFilterName:De}),e.jsx(Ne,{children:e.jsx(Oe,{sx:{overflow:"unset"},children:ce?e.jsx(ee,{display:"flex",justifyContent:"center",alignItems:"center",height:200,children:e.jsx(Ge,{})}):e.jsxs(Be,{sx:{minWidth:800},children:[e.jsx(Me,{order:u,orderBy:m,rowCount:l.length,headLabel:[{id:"sr",label:"Sr."},{id:"name",label:"Name"},{id:"mobile",label:"Mobile"},{id:"city",label:"City/Country"},{id:"pain",label:"Pain"},{id:"url",label:"URL"},{id:"start_date",label:"Start Date"},{id:"end_date",label:"End Date"},{id:"package",label:"Package"},{id:"assign_to",label:"Assigned To"},{id:"type_id",label:"Client Of"},{id:"actions",label:"Actions",align:"center"}],onRequestSort:pe}),e.jsx(He,{children:G.slice(n*I,n*I+I).map((s,t)=>e.jsx(ea,{sr:t+1,isAdmin:Y,row:s,handleEdit:()=>je({...s}),handleDelete:fe,teammates:q(s.assign_to),handleAssignChange:xe},s.id))})]})})}),e.jsx(Ke,{page:n,component:"div",count:l.length,rowsPerPage:I,onPageChange:ve,rowsPerPageOptions:[10,20,50],onRowsPerPageChange:Se})]}),P&&e.jsxs(Qe,{open:P,onClose:W,children:[e.jsx(Ve,{children:F?"Edit Patient":"Add New Patient"}),e.jsx(Je,{children:e.jsxs(g,{xs:12,container:!0,spacing:2,children:[e.jsx(g,{xs:12,item:!0,sm:6,children:e.jsx(b,{margin:"dense",name:"name",required:!0,label:"Name",type:"text",fullWidth:!0,value:(a==null?void 0:a.name)||"",onChange:p})}),e.jsx(g,{xs:12,item:!0,sm:6,children:e.jsx(b,{margin:"dense",name:"mobile",label:"Mobile",type:"number",fullWidth:!0,value:(a==null?void 0:a.mobile)||"",onChange:p})}),e.jsx(g,{xs:12,item:!0,sm:6,children:e.jsx(b,{margin:"dense",name:"city",label:"City/State",type:"text",fullWidth:!0,value:(a==null?void 0:a.city)||"",onChange:p})}),e.jsx(g,{xs:12,item:!0,sm:6,children:e.jsx(b,{margin:"dense",name:"country",label:"Country",type:"text",fullWidth:!0,value:(a==null?void 0:a.country)||"",onChange:p})}),e.jsx(g,{xs:12,item:!0,sm:12,children:e.jsxs(R,{fullWidth:!0,margin:"dense",children:[e.jsx(B,{children:"Pain"}),e.jsx(O,{multiple:!0,value:(a==null?void 0:a.pain)||[],onChange:_e,input:e.jsx(te,{label:"Pain"}),renderValue:s=>s==null?void 0:s.join(","),children:he.map(s=>{var t;return e.jsxs(C,{value:s,children:[e.jsx(Ze,{checked:((t=a==null?void 0:a.pain)==null?void 0:t.includes(s))||""}),e.jsx($e,{primary:s})]},s)})})]})}),e.jsx(g,{xs:12,item:!0,sm:6,children:e.jsx(b,{margin:"dense",name:"start_date",label:"Start Date",type:"date",fullWidth:!0,InputLabelProps:{shrink:!0},value:(a==null?void 0:a.start_date)||"",onChange:p})}),e.jsx(g,{xs:12,item:!0,sm:6,children:e.jsx(b,{margin:"dense",name:"end_date",label:"End Date",type:"date",fullWidth:!0,InputLabelProps:{shrink:!0},value:(a==null?void 0:a.end_date)||"",onChange:p})}),e.jsx(g,{xs:12,item:!0,sm:12,children:e.jsxs(R,{variant:"outlined",fullWidth:!0,children:[e.jsx(B,{id:"demo-simple-select-outlined-label",children:"Select Package"}),e.jsxs(O,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",name:"package",value:a==null?void 0:a.package,onChange:p,label:"Select Package",children:[e.jsx(C,{value:1,children:"FITNAT Coaching Premium"}),e.jsx(C,{value:2,children:"FITNAT Coaching Delux"}),e.jsx(C,{value:3,children:"FITNAT Coaching Personal Training"})]})]})}),e.jsx(g,{xs:12,item:!0,sm:12,children:e.jsx(b,{margin:"dense",name:"url",label:"URL",type:"text",fullWidth:!0,value:(a==null?void 0:a.url)||"",onChange:p})}),e.jsx(g,{item:!0,xs:12,sm:12,children:e.jsxs(R,{fullWidth:!0,margin:"dense",children:[e.jsx(B,{children:"Assign To"}),e.jsxs(O,{value:(a==null?void 0:a.assign_to)||"",onChange:Ce,children:[e.jsx(C,{value:"",children:e.jsx("em",{children:"None"})}),k.map(s=>e.jsx(C,{value:s.id,children:s.name},s.id))]})]})})]})}),e.jsxs(Xe,{children:[e.jsx(T,{onClick:W,children:"Cancel"}),e.jsx(T,{onClick:be,children:F?"Save":"Add"})]})]}),e.jsx(ze,{openDialog:_,message:"Are You Sure",handleSave:Te})]})}export{Sa as default};
