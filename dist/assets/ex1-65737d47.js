import{r as i,j as a,c as ye,B as V,d as Se,T as J,I as X,a as L,g as z,S as ve,b as De}from"./index-d5588370.js";import{Q as Te,B as b}from"./ReactToastify-68a980f8.js";import{c as T,a as Ie,P as E,u as _e,b as ke,d as Ae}from"./api_utils-656155e4.js";import{f as Y}from"./date_time-0f4139e7.js";import{U as Ne}from"./user-table-head-46a53a7c.js";import{c as Fe,d as c,T as we,a as Le,e as Ee}from"./TableRow-175fc24b.js";import{B as C}from"./Button-acd88f2b.js";import{O as Z,T as j,F as q,I as G,S as K}from"./TextField-3d7d31c2.js";import{I as We}from"./InputAdornment-23b4c846.js";import{C as Re}from"./confirmation_dialog-99ddd2dc.js";import{C as Ue}from"./Container-336572a5.js";import{C as Me}from"./Card-3d016d94.js";import{C as Oe}from"./CircularProgress-dbf426da.js";import{T as Pe,D as Be,a as He,b as ze,c as Ye}from"./TablePagination-b0e6ee39.js";import{G as h}from"./Grid-49b1bf41.js";import{M as I,C as qe}from"./MenuItem-b7847bdd.js";import{L as Ge}from"./TableSortLabel-8cc8e201.js";import"./Menu-b71dbcde.js";function Ke({row:l,handleEdit:r,sr:n,isAdmin:o,handleDelete:d}){var x,u;return i.useState(null),a.jsxs(Fe,{hover:!0,tabIndex:-1,children:[a.jsx(c,{children:n}),a.jsx(c,{children:l.name}),a.jsx(c,{children:l.mobile}),a.jsx(c,{children:l.city+"/"+l.country}),a.jsx(c,{children:(u=(x=l.pain)==null?void 0:x.split(","))==null?void 0:u.join(`
`)}),a.jsx(c,{children:a.jsx("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",children:l.url})}),a.jsx(c,{children:new Date(l.start_date).toLocaleDateString()}),a.jsx(c,{children:new Date(l.end_date).toLocaleDateString()}),a.jsx(c,{children:ye(l.package)}),a.jsx(c,{children:l.type_id==1?"Dr. Dhairya":"Dr. Nidhi"}),a.jsx(c,{align:"right",children:a.jsxs(V,{display:"flex",justifyContent:"flex-end",children:[a.jsx(C,{variant:"contained",disabled:!o,size:"small",onClick:r,color:"primary",sx:{marginRight:1},children:"Edit"}),a.jsx(C,{variant:"contained",disabled:!o,size:"small",color:"error",onClick:()=>d(l.id),children:"Delete"})]})})]},l.id)}function $({numSelected:l,filterName:r,onFilterName:n}){return a.jsx(Se,{sx:{height:96,display:"flex",justifyContent:"space-between",p:o=>o.spacing(0,1,0,3),...l>0&&{color:"primary.main",bgcolor:"primary.lighter"}},children:l>0?a.jsxs(J,{component:"div",variant:"subtitle1",children:[l," selected"]}):a.jsx(Z,{value:r,onChange:n,placeholder:"Search user...",startAdornment:a.jsx(We,{position:"start",children:a.jsx(X,{icon:"eva:search-fill",sx:{color:"text.disabled",width:20,height:20}})})})})}$.propTypes={numSelected:L.number,filterName:L.string,onFilterName:L.func};function Q(l,r,n){return l[n]===null?1:r[n]===null||r[n]<l[n]?-1:r[n]>l[n]?1:0}function Qe(l,r){return l==="desc"?(n,o)=>Q(n,o,r):(n,o)=>-Q(n,o,r)}function Ve({inputData:l,comparator:r,filterName:n}){const o=l.map((d,x)=>[d,x]);return o.sort((d,x)=>{const u=r(d[0],x[0]);return u!==0?u:d[1]-x[1]}),l=o.map(d=>d[0]),n&&(l=l.filter(d=>d.name.toLowerCase().indexOf(n.toLowerCase())!==-1)),l}function ua(){const[l,r]=i.useState([]),[n,o]=i.useState(0),[d,x]=i.useState("asc"),[u,ee]=i.useState("name"),[ae,W]=i.useState(!1),[_,se]=i.useState(""),[y,le]=i.useState(10),[R,k]=i.useState(!1),[e,S]=i.useState(null),[A,N]=i.useState(!1),[v,F]=i.useState(!1),[te,ne]=i.useState(-1),[ie,U]=i.useState(!1),[M,oe]=i.useState(),re=["Headache","Neck Pain","Shoulder Pain","Back Pain","Hip Pain","Knee Pain","Ankle Pain","Foot Pain","Elbow Pain","Wrist Pain","Hand Pain","Chest Pain"];i.useEffect(()=>{var t;de();let s=(t=z("data"))==null?void 0:t.isMaster;oe(s)},[v]);const de=async()=>{try{U(!0);const s=await T(Ie,{table:E});console.log(">>>>>>>",s),r(s.data.data),U(!1)}catch(s){console.error("Failed to fetch patient:",s)}},ce=(s,t)=>{x(u===t&&d==="asc"?"desc":"asc"),ee(t)},me=(s={})=>{var f;let t=Y(s==null?void 0:s.start_date),g=Y(s==null?void 0:s.end_date),D=(f=s==null?void 0:s.pain)==null?void 0:f.split(",");s.start_date=t,s.end_date=g,s.pain=D,S(s),N(!0),k(!0)},he=s=>{try{W(!0),ne(s)}catch(t){console.error("Failed to delete patient:",t)}},w=()=>{k(!1),S({}),N(!1)},xe=async()=>{var t,g,D,f,P,B,H;if(!(e!=null&&e.start_date)||!(e!=null&&e.end_date)||new Date(e==null?void 0:e.start_date)>=new Date(e==null?void 0:e.end_date)){b.error("please select valid dates");return}if(console.log(e==null?void 0:e.pain),!((t=e==null?void 0:e.name)!=null&&t.trim())||!((g=e==null?void 0:e.city)!=null&&g.trim())||!((D=e==null?void 0:e.country)!=null&&D.trim())||!((P=(f=e==null?void 0:e.pain)==null?void 0:f.join())!=null&&P.length)||!(e!=null&&e.package)||!((B=e==null?void 0:e.url)!=null&&B.trim())||((H=e==null?void 0:e.mobile)==null?void 0:H.trim().length)!=10){b.error("please provide all Details");return}let s=e==null?void 0:e.pain.join(",");if(e.pain=s,A)try{let m=await T(_e,{...e,table:E});F(!v),console.log("response",m),b.success("Patient Updated Successfully")}catch(m){console.error("Failed to update patient:",m),b.error("Failed to update patient")}else{const m=z("data");console.log("Patient",e);const Ce=await T(ke,{...e,type_id:m==null?void 0:m.type_id,created_by:m==null?void 0:m.id});F(!v),console.log(">>>>>>>",Ce),b.success("New Patient Added Successfully")}w()},ue=()=>{N(!1),k(!0)},pe=(s,t)=>{o(t)},ge=s=>{o(0),le(parseInt(s.target.value,10))},je=s=>{o(0),se(s.target.value)},p=s=>{const{name:t,value:g}=s.target;S({...e,[t]:g})},O=Ve({inputData:l,comparator:Qe(d,u),filterName:_}),fe=async s=>{if(console.log(">>>>>",s),s){let t=await T(Ae,{table:E,id:te});F(!v),console.log("response",t)}W(!1)},be=s=>{const{target:{value:t}}=s;console.log(t),S({...e,pain:t})};return O.length,a.jsxs(Ue,{maxWidth:"xl",children:[a.jsx(Te,{position:"top-right"}),a.jsxs(ve,{direction:"row",alignItems:"center",justifyContent:"space-between",mb:5,children:[a.jsx(J,{variant:"h4",children:"Patients"}),M&&a.jsx(C,{variant:"contained",color:"inherit",startIcon:a.jsx(X,{icon:"eva:plus-fill"}),onClick:ue,children:"New Patient"})]}),a.jsxs(Me,{children:[a.jsx($,{numSelected:0,filterName:_,onFilterName:je}),a.jsx(De,{children:a.jsx(we,{sx:{overflow:"unset"},children:ie?a.jsx(V,{display:"flex",justifyContent:"center",alignItems:"center",height:200,children:a.jsx(Oe,{})}):a.jsxs(Le,{sx:{minWidth:800},children:[a.jsx(Ne,{order:d,orderBy:u,rowCount:l.length,headLabel:[{id:"sr",label:"Sr."},{id:"name",label:"Name"},{id:"mobile",label:"Mobile"},{id:"city",label:"City/Country"},{id:"pain",label:"Pain"},{id:"url",label:"URL"},{id:"start_date",label:"Start Date"},{id:"end_date",label:"End Date"},{id:"package",label:"Package"},{id:"type_id",label:"Client Of"},{id:"actions",label:"Actions",align:"center"}],onRequestSort:ce}),a.jsx(Ee,{children:O.slice(n*y,n*y+y).map((s,t)=>a.jsx(Ke,{sr:t+1,isAdmin:M,row:s,handleEdit:()=>me({...s}),handleDelete:he}))})]})})}),a.jsx(Pe,{page:n,component:"div",count:l.length,rowsPerPage:y,onPageChange:pe,rowsPerPageOptions:[10,20,50],onRowsPerPageChange:ge})]}),R&&a.jsxs(Be,{open:R,onClose:w,children:[a.jsx(He,{children:A?"Edit Patient":"Add New Patient"}),a.jsx(ze,{children:a.jsxs(h,{xs:12,container:!0,spacing:2,children:[a.jsx(h,{xs:12,item:!0,sm:6,children:a.jsx(j,{margin:"dense",name:"name",required:!0,label:"Name",type:"text",fullWidth:!0,value:(e==null?void 0:e.name)||"",onChange:p})}),a.jsx(h,{xs:12,item:!0,sm:6,children:a.jsx(j,{margin:"dense",name:"mobile",label:"Mobile",type:"number",fullWidth:!0,value:(e==null?void 0:e.mobile)||"",onChange:p})}),a.jsx(h,{xs:12,item:!0,sm:6,children:a.jsx(j,{margin:"dense",name:"city",label:"City/State",type:"text",fullWidth:!0,value:(e==null?void 0:e.city)||"",onChange:p})}),a.jsx(h,{xs:12,item:!0,sm:6,children:a.jsx(j,{margin:"dense",name:"country",label:"Country",type:"text",fullWidth:!0,value:(e==null?void 0:e.country)||"",onChange:p})}),a.jsx(h,{xs:12,item:!0,sm:12,children:a.jsxs(q,{fullWidth:!0,margin:"dense",children:[a.jsx(G,{children:"Pain"}),a.jsx(K,{multiple:!0,value:(e==null?void 0:e.pain)||[],onChange:be,input:a.jsx(Z,{label:"Pain"}),renderValue:s=>s==null?void 0:s.join(","),children:re.map(s=>{var t;return a.jsxs(I,{value:s,children:[a.jsx(qe,{checked:((t=e==null?void 0:e.pain)==null?void 0:t.includes(s))||""}),a.jsx(Ge,{primary:s})]},s)})})]})}),a.jsx(h,{xs:12,item:!0,sm:6,children:a.jsx(j,{margin:"dense",name:"start_date",label:"Start Date",type:"date",fullWidth:!0,InputLabelProps:{shrink:!0},value:(e==null?void 0:e.start_date)||"",onChange:p})}),a.jsx(h,{xs:12,item:!0,sm:6,children:a.jsx(j,{margin:"dense",name:"end_date",label:"End Date",type:"date",fullWidth:!0,InputLabelProps:{shrink:!0},value:(e==null?void 0:e.end_date)||"",onChange:p})}),a.jsx(h,{xs:12,item:!0,sm:12,children:a.jsxs(q,{variant:"outlined",fullWidth:!0,children:[a.jsx(G,{id:"demo-simple-select-outlined-label",children:"Select Package"}),a.jsxs(K,{labelId:"demo-simple-select-outlined-label",id:"demo-simple-select-outlined",name:"package",value:e==null?void 0:e.package,onChange:p,label:"Select Package",children:[a.jsx(I,{value:1,children:"FITNAT Coaching Premium"}),a.jsx(I,{value:2,children:"FITNAT Coaching Delux"}),a.jsx(I,{value:3,children:"FITNAT Coaching Personal Training"})]})]})}),a.jsx(h,{xs:12,item:!0,sm:12,children:a.jsx(j,{margin:"dense",name:"url",label:"URL",type:"text",fullWidth:!0,value:(e==null?void 0:e.url)||"",onChange:p})})]})}),a.jsxs(Ye,{children:[a.jsx(C,{onClick:w,children:"Cancel"}),a.jsx(C,{onClick:xe,children:A?"Save":"Add"})]})]}),a.jsx(Re,{openDialog:ae,message:"Are You Sure",handleSave:fe})]})}export{ua as default};
